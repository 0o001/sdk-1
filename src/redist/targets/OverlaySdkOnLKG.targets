<Project ToolsVersion="14.0" DefaultTargets="Test">
  <Target Name="OverlaySdkOnLKG" AfterTargets="Build" DependsOnTargets="GenerateLayout">
    <PropertyGroup>
      <RedistLayoutPath>$(BaseOutputPath)$(Configuration)\dotnet\</RedistLayoutPath>
    </PropertyGroup>

    <ItemGroup>
      <OverlaySDK Include="$(_DotNetHiveRoot)/**/*" Exclude="$(_DotNetHiveRoot)sdk/**/*"/>
      <ToolsetToOverlay Include="$(OutputPath)/**/*" />
    </ItemGroup>

    <Copy SourceFiles="@(OverlaySDK)"
          DestinationFiles="@(OverlaySDK->'$(RedistLayoutPath)\%(RecursiveDir)%(Filename)%(Extension)')" />

    <PropertyGroup>
      <SdkOutputDirectory>$(RedistLayoutPath)/sdk/$(Version)</SdkOutputDirectory>
    </PropertyGroup>

    <Copy SourceFiles="@(ToolsetToOverlay)"
          DestinationFiles="@(ToolsetToOverlay->'$(SdkOutputDirectory)\%(RecursiveDir)%(Filename)%(Extension)')" />
  </Target>
</Project>
